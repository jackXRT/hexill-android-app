
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>HEXILL | Hash Scanner & Cracker</title>
<!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"> -->                                                               
 <link rel="stylesheet" href="css/styles.css">
 <script src="js/billing.js"></script>
</head>
<body>

  <!-- Sidebar -->
  <aside class="sidebar">
    <div class="sidebar-header">
      <div class="logo">
        <i class="fas fa-search"></i>
        <span>HEXILL</span>
      </div>                           
      <button class="close-sidebar" onclick="toggleSidebar()">
  √ó
 </button>
 </div>
    
    <div class="sidebar-menu">
      <button class="upgrade-btn" onclick="showUpgradeModal()">
        <i class="fas fa-crown"></i> Upgrade to Pro
      </button>
    </div>
    
    <!-- User Info in Sidebar (hidden by default) -->
    <div class="sidebar-user-info" id="sidebarUserInfo" style="display: none; position: absolute; bottom: 20px; left: 20px; right: 20px; padding: 15px; background: rgba(0,255,247,0.1); border-radius: 10px; border: 1px solid rgba(0,255,247,0.3);">
      <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
        <i class="fas fa-user-circle" style="color: #00fff7; font-size: 1.2em;"></i>
        <span id="sidebarUserEmail" style="color: #00fff7; font-size: 0.9em; flex: 1; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;"></span>
      </div>
      <button onclick="logoutUser()" style="width: 100%; background: none; border: 1px solid #ff4444; color: #ff4444; padding: 8px 12px; border-radius: 5px; cursor: pointer; font-size: 0.85em;">
        <i class="fas fa-sign-out-alt"></i> Logout
     </button>
    </div>
  </aside>

  <!-- Upgrade Modal -->
  <div class="upgrade-modal" id="upgradeModal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Upgrade to HEXILL Pro</h2>
         <button class="close-modal" onclick="hideUpgradeModal()" style="position: absolute; top: 15px; right: 20px; background: none; border: none; color: #fff; font-size: 1.5rem; cursor: pointer; padding: 5px;">
  √ó
</button>        
        </button>
      </div>
      <div class="modal-body">
        <h3>Pro Features</h3>
        <ul class="features-list">
          <li><i class="fas fa-check"></i> Access to Cloud GPU</li>
          <li><i class="fas fa-check"></i> Unlimited Cracking</li>
          <li><i class="fas fa-check"></i> Priority Processing</li>
          <li><i class="fas fa-check"></i> Advanced Security</li>
          <li><i class="fas fa-check"></i> AI-Assisted Cracking</li>
        </ul>
      </div>
      <div class="modal-footer">
       <button class="pro-upgrade-btn" onclick="launchPlayBilling()">Upgrade to Pro</button>
    </div>
    </div>
  </div>

  <!-- Header -->
  <header class="top-header">
    <div class="header-left" style="display: flex; align-items: center;">
      <button class="hamburger-btn" onclick="toggleSidebar()" aria-label="Toggle Sidebar" style="background: none; border: none; padding: 0; margin-right: 10px; cursor: pointer;">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="#00fff7" xmlns="http://www.w3.org/2000/svg">
          <rect x="3" y="6" width="18" height="2" rx="1"></rect>
          <rect x="3" y="12" width="12" height="2" rx="1"></rect>
        </svg>
      </button>
      <span class="logo-text" style="font-size: 1.5rem; font-weight: bold; color: #00fff7;">HEXILL</span>
    </div>
    
    <!-- Auth Buttons in Header -->
    <div class="auth-header-buttons" id="authHeaderButtons" style="display: flex; align-items: center; gap: 15px;">
      <a href="login.html" style="color: #00fff7; text-decoration: none; padding: 8px 16px; border: 1px solid #00fff7; border-radius: 20px; transition: all 0.3s;">Log in</a>
      <a href="signup.html" style="background: #00fff7; color: #000; text-decoration: none; padding: 8px 16px; border-radius: 20px; font-weight: bold; transition: all 0.3s;">Sign up</a>
    </div>
  </header>

  <!-- Main Content -->
  <main class="main-content">
    <div class="scan-container">
      <h1><i class="fas fa-search"></i> HEXILL Scanner</h1>
      <p class="tagline">Scan and crack hashes (SHA256, CRC32, MD5, TxID, IPFS...)</p>
      
      <div class="input-wrapper">
        <input 
          type="text" 
          id="hashInput" 
          placeholder="Enter hash, transaction ID, or IPFS CID..."
          autocomplete="off"
          autocorrect="off"
          autocapitalize="off"
          spellcheck="false"
          data-form-type="other"
          data-lpignore="true"
        >
        <span class="clear-btn" onclick="clearInput()">√ó</span>
      </div>
      
      <div class="action-buttons">
        <button id="scan-btn" class="scan-btn">
          <i class="fas fa-search"></i> Scan Hash
        </button>
        <button id="crack-btn" class="crack-btn">
          <i class="fas fa-unlock"></i> Crack Hash
        </button>
      </div>
     
      <div class="result-box" id="result">
        <div class="scan-status" id="status">
          <i class="fas fa-magnifying-glass"></i>
          <p>Ready to scan</p>
        </div>
        <pre id="resultContent" class="hidden"></pre>
      </div>
      
      <div class="disclaimer">
        <i class="fas fa-info-circle"></i>
        <small>For educational purposes only. Do not use for illegal activities.</small>
      </div>
    </div>
  </main>

  <!-- üî• FIREBASE v12 - IMPROVED WITH BETTER AUTH DETECTION -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/12.0.0/firebase-app.js";
    import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/12.0.0/firebase-auth.js";
    import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/12.0.0/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyCwOL-Xqobv-JZI8XqnOr9kbnavHtBoeh8",
      authDomain: "hexill-app.firebaseapp.com",
      projectId: "hexill-app",
      storageBucket: "hexill-app.appspot.com",
      messagingSenderId: "838614935678",
      appId: "1:838614935678:web:c361fd717edfb38b68902f"
    };

    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);
    
    console.log("üî• Firebase v12 initialized successfully!");

    // Make Firebase available globally for scanner.js
    window.firebaseApp = app;
    window.firebaseAuth = auth;
    window.firebaseDb = db;
    window.firebase = { auth: () => auth, firestore: () => db }; // Legacy compatibility

    // Set default values
    window.hexillAccountType = 'free';
    window.currentFirebaseUser = null;

    // Function to update UI based on auth state
    function updateAuthUI(user) {
      const authHeaderButtons = document.getElementById('authHeaderButtons');
      const sidebarUserInfo = document.getElementById('sidebarUserInfo');
      const sidebarUserEmail = document.getElementById('sidebarUserEmail');

      if (user) {
        // User is logged in
        authHeaderButtons.style.display = 'none';
        sidebarUserInfo.style.display = 'block';
        sidebarUserEmail.textContent = user.email;
      } else {
        // User is not logged in
        authHeaderButtons.style.display = 'flex';
        sidebarUserInfo.style.display = 'none';
      }
    }

    // Function to handle user data
    async function handleUser(user) {
      updateAuthUI(user);
      
      if (user) {
        console.log("üî• Processing Firebase user:", user.email);
        console.log("üî• User UID:", user.uid);
        
        try {
          // Get user data from Firestore
          const userDoc = await getDoc(doc(db, 'users', user.uid));
          if (userDoc.exists()) {
            const userData = userDoc.data();
            console.log('üî• Firestore user data:', userData);
            
            // Set account type globally
            const accountType = userData.accountType || (userData.isPro ? 'pro' : 'free');
            window.hexillAccountType = accountType;
            console.log('üî• Account type set to:', accountType);
            
            // Store user data globally
            window.currentFirebaseUser = {
              email: user.email,
              uid: user.uid,
              accountType: accountType,
              userData: userData
            };
            
            console.log('‚úÖ Firebase user data ready!');
          } else {
            console.log('‚ùå No Firestore document found for user:', user.uid);
            window.hexillAccountType = 'free';
            window.currentFirebaseUser = {
              email: user.email,
              uid: user.uid,
              accountType: 'free',
              userData: null
            };
          }
        } catch (error) {
          console.error('‚ùå Error fetching user data:', error);
          window.hexillAccountType = 'free';
          window.currentFirebaseUser = {
            email: user.email,
            uid: user.uid,
            accountType: 'free',
            userData: null
          };
        }
      } else {
        console.log("üî• No Firebase user signed in");
        window.hexillAccountType = 'free';
        window.currentFirebaseUser = null;
      }
    }

    // Function to logout user
    window.logoutUser = async function() {
      try {
        await signOut(auth);
        console.log('‚úÖ User logged out successfully');
      } catch (error) {
        console.error('‚ùå Error logging out:', error);
      }
    }

    // Check authentication state immediately and on changes
    onAuthStateChanged(auth, handleUser);
    
    // Also check current user immediately (in case already logged in)
    if (auth.currentUser) {
      console.log("üî• Found existing user session");
      handleUser(auth.currentUser);
    }

    // Debug function
    window.checkFirebase = function() {
      console.log('=== FIREBASE DEBUG ===');
      console.log('Firebase app:', app);
      console.log('Auth current user:', auth.currentUser);
      console.log('Global account type:', window.hexillAccountType);
      console.log('Global user data:', window.currentFirebaseUser);
      console.log('====================');
    };

    // Force refresh user data
    window.refreshUserData = function() {
      if (auth.currentUser) {
        console.log('üîÑ Refreshing user data...');
        handleUser(auth.currentUser);
      } else {
       console.log('‚ùå No current user to refresh');
      }
    };
  </script>

  <!-- Other scripts - LOAD AFTER FIREBASE -->
  <script src="js/crypto-js.min.js"></script>
  <script src="js/utils.js"></script>
  <script src="js/cracker.js"></script>
  <script src="js/scanner.js"></script>
  
  <script>
     // UI Functions
    function toggleSidebar() {
      document.querySelector('.sidebar').classList.toggle('active');
    }

    function showUpgradeModal() {
      document.getElementById('upgradeModal').classList.add('show');
    }

    function hideUpgradeModal() {
      document.getElementById('upgradeModal').classList.remove('show');
    }

    function clearInput() {
      document.getElementById('hashInput').value = '';
    }
      function launchPlayBilling() {
  purchaseProUpgrade();
}
    // Close modal when clicking outside
    window.addEventListener('click', function(event) {
      if (event.target === document.getElementById('upgradeModal')) {
        hideUpgradeModal();
      }
    });             
  </script> 
</body>
</html>
